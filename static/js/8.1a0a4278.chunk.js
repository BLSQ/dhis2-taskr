(this["webpackJsonpdhis2-importer"]=this["webpackJsonpdhis2-importer"]||[]).push([[8,9],{1160:function(e,t,o){"use strict";o.r(t);var n=o(1056),r=o(1148),i=o.n(r),s=o(1155),a=o(0),l=o.n(a),c=o(124),p=o(1151),d=o(1152),u=o(1154),h=o(902),m=o.n(h),g=(o(1156),o(936)),f=o(903);m.a.Control.MousePosition=m.a.Control.extend({_pos:null,options:{position:"bottomleft",separator:" : ",emptyString:"Unavailable",lngFirst:!1,numDigits:5,lngFormatter:void 0,latFormatter:void 0,formatter:void 0,prefix:"",wrapLng:!0},onAdd:function(e){return this._container=m.a.DomUtil.create("div","leaflet-control-mouseposition"),m.a.DomEvent.disableClickPropagation(this._container),e.on("mousemove",this._onMouseMove,this),this._container.innerHTML=this.options.emptyString,this._container},onRemove:function(e){e.off("mousemove",this._onMouseMove)},getLatLng:function(){return this._pos},_onMouseMove:function(e){this._pos=e.latlng.wrap();var t,o,n,r,i=this.options.wrapLng?e.latlng.wrap().lng:e.latlng.lng,s=e.latlng.lat;this.options.formatter?r=this.options.formatter(i,s):(t=this.options.lngFormatter?this.options.lngFormatter(i):m.a.Util.formatNum(i,this.options.numDigits),o=this.options.latFormatter?this.options.latFormatter(s):m.a.Util.formatNum(s,this.options.numDigits),n=this.options.lngFirst?t+this.options.separator+o:o+this.options.separator+t,r=this.options.prefix+" "+n),this._container.innerHTML=r}}),m.a.Map.mergeOptions({positionControl:!1}),m.a.Map.addInitHook((function(){this.options.positionControl&&(this.positionControl=new m.a.Control.MousePosition,this.addControl(this.positionControl))})),m.a.control.mousePosition=function(e){return new m.a.Control.MousePosition(e)};class j extends g.a{constructor(e){super(e)}createLeafletElement(e){return this.control=m.a.control.mousePosition().addTo(e.leaflet.map),this.control}}var b=Object(f.d)(j),y=o(305),v=o(304),x=o(392),O=o(411),w=o(308),C=o(4);const E=()=>{const e=new WeakSet;return(t,o)=>{if("object"===typeof o&&null!==o){if(e.has(o))return;e.add(o)}return o}},S=["LineString","Polygon","MultiPolygon"],M=[{name:"Thunderforest - Landscapes",attribution:"Thunderforest and OpenStreetMap contributors.",url:"https://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}{r}.png?apikey=7c352c8ff1244dd8b732e349e0b0fe8d"},{name:"Thunderforest - Outdoors",attribution:"Thunderforest and OpenStreetMap contributors.",url:"https://{s}.tile.thunderforest.com/outdoors/{z}/{x}/{y}{r}.png?apikey=7c352c8ff1244dd8b732e349e0b0fe8d"},{name:"Stamen Design - Toner",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"},{name:"Stamen Design - Water color",url:"https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'},{name:"Google maps - Satelite",url:"http://mt3.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",attribution:"Google"}];function L(e){return"string"==typeof e}function k(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}t.default=function({lines:e,position:t,showableMap:o,width:r,height:m,showLayers:g}){const[f,j]=Object(a.useState)(""),[P,T]=Object(a.useState)(""),[_,D]=Object(a.useState)(M[0]),[F,B]=l.a.useState(void 0),[N,R]=l.a.useState(void 0),[z,I]=l.a.useState(void 0),A=Object(a.useRef)(null),J=()=>{if(A&&A.current){let o;const r=A.current.leafletElement;if(N&&N.length>0){o=(e=>{const t=[1/0,1/0,-1/0,-1/0];for(let o of e){let e=o.position;t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}return t})(N)}if(o&&o[0]!==1/0){const e=h.latLng(o[0],o[1]),t=h.latLng(o[2],o[3]),n=h.latLngBounds(e,t);r.fitBounds(n)}else if(z&&z.length>0){const o=n,i=o.bbox;var e;try{e=i(o.featureCollection(z.map((e=>o.feature(e)))))}catch(t){e=i(z[0])}if(e){const t=h.latLng(e[1],e[0]),o=h.latLng(e[3],e[2]),n=h.latLngBounds(t,o);r.fitBounds(n)}}}};if(Object(a.useEffect)((()=>{setTimeout((()=>{J()}),2e3)}),[A,N,z]),Object(a.useEffect)((()=>{if(A&&A.current&&A.current.leafletElement){const e=A.current.leafletElement;e.on("click",(function(e){document.getElementsByClassName("leaflet-pixi-overlay")[0].style.zIndex=-1})),e.on("mousemove",h.Util.throttle((function(e){if(e.originalEvent){var t=e.originalEvent.target;let n=document.getElementsByClassName("leaflet-pixi-overlay")[0];if(n&&"body"!==n.nodeName.toLowerCase()&&-1===n.classList.value.indexOf("leaflet-container")&&t!==n){var o=new MouseEvent(e.type,e.originalEvent);n.style.zIndex=1e3,(!n.dispatchEvent(o)||o._stopped)&&h.DomEvent.stop(e)}}}),32))}}),[A]),Object(a.useEffect)((()=>{if(void 0==e)return;const t=e.filter((e=>{if(void 0==e)return!1;if(void 0===e.coordinates&&void 0===e.coordinate&&void 0===e.geometry)return!1;return!!(e.coordinate&&e.coordinate.latitude&&e.coordinate.longitude)||(!(!e.geometry||"Point"!=e.geometry.type)||void 0!==e.coordinates&&(L(e.coordinates)&&!e.coordinates.startsWith("[[")&&""!=e.coordinates))})),o=e.filter((e=>e.coordinates&&L(e.coordinates)&&e.coordinates.startsWith("[[")||e.geometry&&e.geometry.type&&S.includes(e.geometry.type))).map((e=>{let t=e.geometry;try{t=n.polygon(JSON.parse(e.coordinates))}catch(o){try{t=n.multiPolygon(JSON.parse(e.coordinates))}catch(o){}}return t&&(void 0==t.properties&&(t.properties={}),t.properties&&(t.properties.line=e)),t})).filter((e=>e)),r=t.map(((e,t)=>{const o=e.coordinate&&e.coordinate.latitude&&e.coordinate.longitude?[e.coordinate.latitude,e.coordinate.longitude]:e.coordinates?JSON.parse(e.coordinates).reverse():e.geometry&&e.geometry.coordinates.slice(0).reverse(),n=e.color||"red";return{id:"points"+t,key:"points"+t,iconColor:n,position:o,tooltip:()=>Object(s.renderToString)(Object(C.jsx)("div",{children:Object.keys(e).map((t=>Object(C.jsxs)("div",{children:[Object(C.jsx)("b",{children:t})," ",Object(C.jsx)(c.a,{value:e[t]})]})))})),customIcon:'<svg xmlns="http://www.w3.org/2000/svg" fill="'+n+'" width="5" height="5" viewBox="0 0 5 5"><circle cx="0" cy="0" r="5" stroke="'+n+'" stroke-width="5" fill="'+n+'" /></svg>'}}));R(r),I(o),B(t),J()}),[e]),void 0==e||null==e)return Object(C.jsx)(C.Fragment,{});if(!o)return Object(C.jsx)("p",{children:"Map will show if the lines contains a 'coordinates' or 'geometry' field"});const U=void 0==z?[]:z.filter((e=>e&&e.properties&&e.properties.line)).map(((e,t)=>{const o=e.properties.line,n="LineString"==e.type?1:.3;o.fillColor=o.fillColor||k();const r={fillColor:o.fillColor,color:o.color||k(),weight:o.opacity||n,opacity:o.opacity||n,fillOpacity:o.opacity||n};return P==o&&(r.weight=3,r.opacity=.8,r.dashArray="5,5"),Object(C.jsx)(p.a,{data:e,style:r,title:JSON.stringify(o,E()),onClick:e=>{!function(e,t){if(t.originalEvent._stopped)return;var o,n=t.originalEvent.target;o={node:n,pointerEvents:n.style.pointerEvents},n.style.pointerEvents="none";let r=document.elementFromPoint(t.originalEvent.clientX,t.originalEvent.clientY);if(r&&"body"!==r.nodeName.toLowerCase()&&-1===r.classList.value.indexOf("leaflet-container")){var i=new MouseEvent(t.originalEvent.type,t.originalEvent);(!r.dispatchEvent(i)||i._stopped)&&h.DomEvent.stop(t)}o.node.style.pointerEvents=o.pointerEvents,T(e)}(o,e)}},"parent-"+t+(P==o?"clicked":"none"))}));return Object(C.jsxs)("div",{className:"avoid-page-break",children:[Object(C.jsx)("p",{children:f}),g&&Object(C.jsxs)("div",{style:{display:"flex"},children:[Object(C.jsxs)(v.a,{children:[Object(C.jsx)(y.a,{children:"Layer"}),Object(C.jsx)(w.a,{onChange:(e,t)=>{D(t.props.value)},value:_,children:M.map((e=>Object(C.jsx)(O.a,{value:e,children:e.name})))})]}),Object(C.jsx)(x.a,{onClick:J,children:"Fit"})]}),Object(C.jsxs)("div",{children:[e.length," records. ",F?F.length:"?"," points displayed. ",U.length," zones displayed."," ",P&&Object.keys(P).filter((e=>!["geometry","coordinates"].includes(e))).map((e=>Object(C.jsxs)("div",{children:[Object(C.jsx)("b",{children:e})," ",Object(C.jsx)(c.a,{value:P[e]})]})))]}),(N&&N[0]||U&&U[0])&&Object(C.jsxs)(d.a,{preferCanvas:!0,doubleClickZoom:!1,center:t,zoom:3,ref:A,style:{width:r||"80%",height:m||"900px",padding:"0px"},children:[Object(C.jsx)(u.a,{..._}),Object(C.jsx)(b,{position:"top",coordinates:"decimal"}),U,N&&N[0]&&Object(C.jsx)(i.a,{markers:N,interactive:!0},"4")]})]})}},1510:function(e,t){},1721:function(e,t,o){"use strict";o.r(t);var n=o(0),r=o.n(n),i=o(209),s=o.n(i),a=o(1712),l=o(943),c=o(1710),p=o(1668),d=o.n(p),u=o(124),h=o(1160),m=o(210),g=o(109),f=o(881),j=o(392),b=o(416),y=o(4);const v=()=>Object(y.jsxs)(r.a.Fragment,{children:[Object(y.jsx)("style",{type:"text/css",children:"@media print{@page {size: A4 landscape}; .reportPage {width: 100%; margin: 0; };"}),Object(y.jsx)("style",{type:"text/css",children:"@media screen {  .reportPage {    width: 29.7cm;    margin: auto  } } ;"})]}),x=()=>Object(y.jsxs)(r.a.Fragment,{children:[Object(y.jsx)("style",{type:"text/css",children:"@media print{@page {size: A4 portrait}; .reportPage {width: 100%; margin: 0; }"}),Object(y.jsx)("style",{type:"text/css",children:"@media screen {  .reportPage {    width: 21cm;    margin: auto  } } "})]});class O extends r.a.Component{render(){const{children:e,value:t}=this.props;return e&&t?t.map((t=>Object(l.mapChildren)(e,(e=>{if("object"!==typeof e)return e;let o=Object.assign({},e.props);return o=Object.keys(e.props).reduce(((e,o)=>(e.iitem=t,e)),o),r.a.cloneElement(e,{...o})})))):null}}const w={...c,IdyllVegaLite:d.a,AsJSON:e=>{const{idyll:t,hasError:o,updateProps:n,data:r,...i}=e;return Object(y.jsx)("div",{children:Object(y.jsx)("pre",{children:JSON.stringify(r,null,2)})})},OrgunitMap:e=>Object(y.jsx)(h.default,{showableMap:!0,position:[-12.9487,9.0131],width:"500px",height:"500px",...e}),FlexBox:e=>{const{idyll:t,hasError:o,updateProps:n,data:r,...i}=e;return Object(y.jsx)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",alignItems:"flex-end"},children:e.children.map((e=>Object(y.jsx)("div",{style:{padding:"10px"},children:e})))})},DataTable:({data:e,label:t,perPage:o,selectableRows:i,children:a,excludedColumns:l})=>{const[c,p]=Object(n.useState)([]),d=e||[],h=new Set;d.forEach((e=>{null!==e&&void 0!==e&&Object.keys(e).forEach((e=>h.add(e)))}));const m=Array.from(h),j=(t||"Result List").replace(/\s/g,"_")+".csv",b=r.a.Children.map(a,(e=>{const t={selectedRows:c};return r.a.isValidElement(e)?r.a.cloneElement(e,t):e}));return Object(y.jsx)(f.a,{theme:Object(g.a)({overrides:{MUIDataTable:{paper:{marginRight:"50px"}}}}),children:Object(y.jsx)(s.a,{title:t||"Result List",data:d,columns:m.map((e=>{return{name:e,options:{filter:!0,display:void 0===l?"true":(t=e,l.split(",").includes(t)?"excluded":"true"),customBodyRender:e=>Object(y.jsx)(u.a,{value:e})}};var t})),options:{filterType:"dropdown",print:!1,responsive:"scrollFullHeight",selectableRows:i||"none",downloadOptions:{filename:j,separator:","},rowsPerPageOptions:[1,10,20,50,100,1e3],rowsPerPage:o||20,selectToolbarPlacement:"above",onRowSelectionChange:(e,t,o)=>{p(o.map((e=>d[e])))},customToolbar:()=>b}})})},DataTableAction:e=>{const{label:t,onClick:o,selectedRows:n}=e;return Object(y.jsx)(b.a,{title:t,children:Object(y.jsx)(j.a,{onClick:e=>{o(n)},children:t})})},PageOrientation:e=>Object(y.jsxs)(r.a.Fragment,{children:["landscape"===e.orientation&&Object(y.jsx)(v,{}),"portrait"===e.orientation&&Object(y.jsx)(x,{})]}),PageBreak:e=>Object(y.jsx)("div",{className:"pagebreak",children:" "}),MyLoop:O,Dhis2Item:e=>{const t=e.iitem,o=t&&t.type?"REPORT_TABLE"==t.type?"reportTable":t.type.toLowerCase():"",i=t&&t[o]?t[o].name:"",[s,a]=r.a.useState(""),[l,c]=r.a.useState("");return Object(n.useEffect)((()=>{if(""!==o){const n=e.prefixUrl||"../../";let r;r="reportTable"==o?"reportTables":o.toLowerCase()+"s";const i=n+r+"/"+t[o].id+"/data",s=async()=>{const e=await fetch(i+".html+css").then((e=>e.text()));a(e)};"reportTable"!==o?(a(""),c(i+".png")):s()}}),[t,o,e.prefixUrl,a]),void 0==t?Object(y.jsx)("p",{children:"hello"}):"reportTable"===o?Object(y.jsx)("div",{dangerouslySetInnerHTML:{__html:s}}):Object(y.jsx)("img",{src:l,alt:i})},Dhis2Content:e=>{const t=e.iitem;return"html"===t.contentType?Object(y.jsx)("div",{dangerouslySetInnerHTML:{__html:t.content}}):Object(y.jsx)("img",{src:t.content,alt:""})}};t.default=({markup:e,dataSets:t})=>{const o={...t.asVars()};return Object(y.jsx)(m.a,{children:Object(y.jsx)(a.a,{theme:"github",markup:e,components:w,initialState:o},t.registeredCount)})}}}]);
//# sourceMappingURL=8.1a0a4278.chunk.js.map