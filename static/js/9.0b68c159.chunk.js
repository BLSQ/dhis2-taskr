(this["webpackJsonpdhis2-importer"]=this["webpackJsonpdhis2-importer"]||[]).push([[9],{1160:function(t,e,o){"use strict";o.r(e);var n=o(1056),i=o(1148),r=o.n(i),s=o(1155),a=o(0),l=o.n(a),c=o(124),p=o(1151),d=o(1152),u=o(1154),h=o(902),m=o.n(h),f=(o(1156),o(936)),g=o(903);m.a.Control.MousePosition=m.a.Control.extend({_pos:null,options:{position:"bottomleft",separator:" : ",emptyString:"Unavailable",lngFirst:!1,numDigits:5,lngFormatter:void 0,latFormatter:void 0,formatter:void 0,prefix:"",wrapLng:!0},onAdd:function(t){return this._container=m.a.DomUtil.create("div","leaflet-control-mouseposition"),m.a.DomEvent.disableClickPropagation(this._container),t.on("mousemove",this._onMouseMove,this),this._container.innerHTML=this.options.emptyString,this._container},onRemove:function(t){t.off("mousemove",this._onMouseMove)},getLatLng:function(){return this._pos},_onMouseMove:function(t){this._pos=t.latlng.wrap();var e,o,n,i,r=this.options.wrapLng?t.latlng.wrap().lng:t.latlng.lng,s=t.latlng.lat;this.options.formatter?i=this.options.formatter(r,s):(e=this.options.lngFormatter?this.options.lngFormatter(r):m.a.Util.formatNum(r,this.options.numDigits),o=this.options.latFormatter?this.options.latFormatter(s):m.a.Util.formatNum(s,this.options.numDigits),n=this.options.lngFirst?e+this.options.separator+o:o+this.options.separator+e,i=this.options.prefix+" "+n),this._container.innerHTML=i}}),m.a.Map.mergeOptions({positionControl:!1}),m.a.Map.addInitHook((function(){this.options.positionControl&&(this.positionControl=new m.a.Control.MousePosition,this.addControl(this.positionControl))})),m.a.control.mousePosition=function(t){return new m.a.Control.MousePosition(t)};class v extends f.a{constructor(t){super(t)}createLeafletElement(t){return this.control=m.a.control.mousePosition().addTo(t.leaflet.map),this.control}}var y=Object(g.d)(v),b=o(305),j=o(304),O=o(392),x=o(411),w=o(308),E=o(4);const C=()=>{const t=new WeakSet;return(e,o)=>{if("object"===typeof o&&null!==o){if(t.has(o))return;t.add(o)}return o}},M=["LineString","Polygon","MultiPolygon"],S=[{name:"Thunderforest - Landscapes",attribution:"Thunderforest and OpenStreetMap contributors.",url:"https://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}{r}.png?apikey=7c352c8ff1244dd8b732e349e0b0fe8d"},{name:"Thunderforest - Outdoors",attribution:"Thunderforest and OpenStreetMap contributors.",url:"https://{s}.tile.thunderforest.com/outdoors/{z}/{x}/{y}{r}.png?apikey=7c352c8ff1244dd8b732e349e0b0fe8d"},{name:"Stamen Design - Toner",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"},{name:"Stamen Design - Water color",url:"https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'},{name:"Google maps - Satelite",url:"http://mt3.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",attribution:"Google"}];function L(t){return"string"==typeof t}function k(){for(var t="#",e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}e.default=function({lines:t,position:e,showableMap:o,width:i,height:m,showLayers:f}){const[g,v]=Object(a.useState)(""),[D,_]=Object(a.useState)(""),[F,N]=Object(a.useState)(S[0]),[P,z]=l.a.useState(void 0),[B,T]=l.a.useState(void 0),[J,U]=l.a.useState(void 0),I=Object(a.useRef)(null),W=()=>{if(I&&I.current){let o;const i=I.current.leafletElement;if(B&&B.length>0){o=(t=>{const e=[1/0,1/0,-1/0,-1/0];for(let o of t){let t=o.position;e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}return e})(B)}if(o&&o[0]!==1/0){const t=h.latLng(o[0],o[1]),e=h.latLng(o[2],o[3]),n=h.latLngBounds(t,e);i.fitBounds(n)}else if(J&&J.length>0){const o=n,r=o.bbox;var t;try{t=r(o.featureCollection(J.map((t=>o.feature(t)))))}catch(e){t=r(J[0])}if(t){const e=h.latLng(t[1],t[0]),o=h.latLng(t[3],t[2]),n=h.latLngBounds(e,o);i.fitBounds(n)}}}};if(Object(a.useEffect)((()=>{setTimeout((()=>{W()}),2e3)}),[I,B,J]),Object(a.useEffect)((()=>{if(I&&I.current&&I.current.leafletElement){const t=I.current.leafletElement;t.on("click",(function(t){document.getElementsByClassName("leaflet-pixi-overlay")[0].style.zIndex=-1})),t.on("mousemove",h.Util.throttle((function(t){if(t.originalEvent){var e=t.originalEvent.target;let n=document.getElementsByClassName("leaflet-pixi-overlay")[0];if(n&&"body"!==n.nodeName.toLowerCase()&&-1===n.classList.value.indexOf("leaflet-container")&&e!==n){var o=new MouseEvent(t.type,t.originalEvent);n.style.zIndex=1e3,(!n.dispatchEvent(o)||o._stopped)&&h.DomEvent.stop(t)}}}),32))}}),[I]),Object(a.useEffect)((()=>{if(void 0==t)return;const e=t.filter((t=>{if(void 0==t)return!1;if(void 0===t.coordinates&&void 0===t.coordinate&&void 0===t.geometry)return!1;return!!(t.coordinate&&t.coordinate.latitude&&t.coordinate.longitude)||(!(!t.geometry||"Point"!=t.geometry.type)||void 0!==t.coordinates&&(L(t.coordinates)&&!t.coordinates.startsWith("[[")&&""!=t.coordinates))})),o=t.filter((t=>t.coordinates&&L(t.coordinates)&&t.coordinates.startsWith("[[")||t.geometry&&t.geometry.type&&M.includes(t.geometry.type))).map((t=>{let e=t.geometry;try{e=n.polygon(JSON.parse(t.coordinates))}catch(o){try{e=n.multiPolygon(JSON.parse(t.coordinates))}catch(o){}}return e&&(void 0==e.properties&&(e.properties={}),e.properties&&(e.properties.line=t)),e})).filter((t=>t)),i=e.map(((t,e)=>{const o=t.coordinate&&t.coordinate.latitude&&t.coordinate.longitude?[t.coordinate.latitude,t.coordinate.longitude]:t.coordinates?JSON.parse(t.coordinates).reverse():t.geometry&&t.geometry.coordinates.slice(0).reverse(),n=t.color||"red";return{id:"points"+e,key:"points"+e,iconColor:n,position:o,tooltip:()=>Object(s.renderToString)(Object(E.jsx)("div",{children:Object.keys(t).map((e=>Object(E.jsxs)("div",{children:[Object(E.jsx)("b",{children:e})," ",Object(E.jsx)(c.a,{value:t[e]})]})))})),customIcon:'<svg xmlns="http://www.w3.org/2000/svg" fill="'+n+'" width="5" height="5" viewBox="0 0 5 5"><circle cx="0" cy="0" r="5" stroke="'+n+'" stroke-width="5" fill="'+n+'" /></svg>'}}));T(i),U(o),z(e),W()}),[t]),void 0==t||null==t)return Object(E.jsx)(E.Fragment,{});if(!o)return Object(E.jsx)("p",{children:"Map will show if the lines contains a 'coordinates' or 'geometry' field"});const A=void 0==J?[]:J.filter((t=>t&&t.properties&&t.properties.line)).map(((t,e)=>{const o=t.properties.line,n="LineString"==t.type?1:.3;o.fillColor=o.fillColor||k();const i={fillColor:o.fillColor,color:o.color||k(),weight:o.opacity||n,opacity:o.opacity||n,fillOpacity:o.opacity||n};return D==o&&(i.weight=3,i.opacity=.8,i.dashArray="5,5"),Object(E.jsx)(p.a,{data:t,style:i,title:JSON.stringify(o,C()),onClick:t=>{!function(t,e){if(e.originalEvent._stopped)return;var o,n=e.originalEvent.target;o={node:n,pointerEvents:n.style.pointerEvents},n.style.pointerEvents="none";let i=document.elementFromPoint(e.originalEvent.clientX,e.originalEvent.clientY);if(i&&"body"!==i.nodeName.toLowerCase()&&-1===i.classList.value.indexOf("leaflet-container")){var r=new MouseEvent(e.originalEvent.type,e.originalEvent);(!i.dispatchEvent(r)||r._stopped)&&h.DomEvent.stop(e)}o.node.style.pointerEvents=o.pointerEvents,_(t)}(o,t)}},"parent-"+e+(D==o?"clicked":"none"))}));return Object(E.jsxs)("div",{className:"avoid-page-break",children:[Object(E.jsx)("p",{children:g}),f&&Object(E.jsxs)("div",{style:{display:"flex"},children:[Object(E.jsxs)(j.a,{children:[Object(E.jsx)(b.a,{children:"Layer"}),Object(E.jsx)(w.a,{onChange:(t,e)=>{N(e.props.value)},value:F,children:S.map((t=>Object(E.jsx)(x.a,{value:t,children:t.name})))})]}),Object(E.jsx)(O.a,{onClick:W,children:"Fit"})]}),Object(E.jsxs)("div",{children:[t.length," records. ",P?P.length:"?"," points displayed. ",A.length," zones displayed."," ",D&&Object.keys(D).filter((t=>!["geometry","coordinates"].includes(t))).map((t=>Object(E.jsxs)("div",{children:[Object(E.jsx)("b",{children:t})," ",Object(E.jsx)(c.a,{value:D[t]})]})))]}),(B&&B[0]||A&&A[0])&&Object(E.jsxs)(d.a,{preferCanvas:!0,doubleClickZoom:!1,center:e,zoom:3,ref:I,style:{width:i||"80%",height:m||"900px",padding:"0px"},children:[Object(E.jsx)(u.a,{...F}),Object(E.jsx)(y,{position:"top",coordinates:"decimal"}),A,B&&B[0]&&Object(E.jsx)(r.a,{markers:B,interactive:!0},"4")]})]})}}}]);
//# sourceMappingURL=9.0b68c159.chunk.js.map